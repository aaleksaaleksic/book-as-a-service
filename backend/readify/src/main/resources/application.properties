spring.application.name=readify

# Database
spring.datasource.url=${DB_URL:jdbc:postgresql://localhost:5432/readify_db}
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# JWT
readify.jwt.secret=${JWT_SECRET}
readify.jwt.expiration=28800000

# JPA
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Server
server.port=8080

# Serbian Payment Configuration
readify.payment.currency=RSD
readify.payment.provider=NLB_PAY
#readify.payment.webhook-url=https://readify.com/api/v1/payments/webhook

readify.subscription.monthly-price=99900
readify.subscription.yearly-price=999900

# Serbian bank integration
readify.payment.nlb.merchant-id=${NLB_MERCHANT_ID}
readify.payment.nlb.secret-key=${NLB_SECRET_KEY}
#readify.payment.nlb.api-url=https://api.nlbpay.rs/v1

# Mock Payment Settings
readify.payment.mock.enabled=true
readify.payment.mock.success-rate=95
# 95% payments will succeed, 5% will fail for testing

# Trial Settings
readify.subscription.trial-duration-days=7

# ============================================
# FILE STORAGE CONFIGURATION
# ============================================

# Local Storage Settings
app.storage.local.base-path=./storage
app.storage.local.books-dir=books
app.storage.local.covers-dir=covers

# File Size Limits
app.storage.max-file-size=73400320
# 70MB max za sve fajlove
app.storage.max-pdf-size=73400320
# 70MB max za PDF
app.storage.max-image-size=5242880
# 5MB max za cover slike
app.streaming.chunk-size=1048576

# Multipart File Upload Configuration
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=70MB
spring.servlet.multipart.max-request-size=80MB
spring.servlet.multipart.resolve-lazily=false
# File se ucitava odmah, ne lazy

# CORS Configuration
# Dozvoljava frontend pristup sa localhost portova
cors.allowed-origins=http://localhost:3000,http://localhost:5173
cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS,HEAD
cors.allowed-headers=Authorization,Content-Type,Accept,X-Readify-Auth,X-Readify-Session,X-Readify-Watermark,X-Readify-Issued-At,Range,If-Range
cors.exposed-headers=Content-Disposition,Content-Length,Content-Range,Accept-Ranges,X-Readify-Watermark,X-Readify-Session,X-Readify-Issued-At
cors.allow-credentials=true

# Logging Levels
logging.level.me.remontada.readify.service.LocalFileStorageService=DEBUG
logging.level.me.remontada.readify.controller.FileController=DEBUG
logging.level.me.remontada.readify.service.BookServiceImpl=INFO
# Za development, videces sve storage operacije

# Request Logging (optional, korisno za debugging)
logging.level.org.springframework.web=DEBUG
# Prikazuje sve HTTP zahteve

# SQL Logging (vec imas ali dodajem za kompletnost)
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
# Prikazuje SQL sa parametrima

# ============================================
# SECURITY CONFIGURATION - Rate Limiting
# ============================================

# Rate Limiting Settings
app.security.rate-limit.enabled=true
app.security.rate-limit.requests-per-minute=10
app.security.rate-limit.burst-size=20
app.security.rate-limit.suspicious-threshold=100
app.security.rate-limit.cleanup-interval-minutes=30

# Session Security
app.streaming.session-ttl-seconds=1800
app.security.ip-binding.enabled=false

# Watermark and Session Security
app.streaming.watermark-secret=${WATERMARK_SECRET:${readify.jwt.secret}}

# ============================================
# EMAIL CONFIGURATION
# ============================================

# Gmail SMTP Configuration
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=${MAIL_USERNAME}
spring.mail.password=${MAIL_PASSWORD}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000

# Email Settings
app.email.from=${MAIL_FROM:${MAIL_USERNAME}}
app.email.from-name=${MAIL_FROM_NAME:Bookotecha}
app.email.enabled=true

# Verification Settings
app.verification.code-length=6
app.verification.token-expiry-hours=24
app.verification.max-attempts=5
app.verification.resend-cooldown-minutes=2
